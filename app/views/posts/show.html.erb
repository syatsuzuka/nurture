

<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><%= link_to "Home", dashboard_path, class: "text-secondary" %></li>
    <li class="breadcrumb-item"><%= link_to "Knowledge", knowledge_path, class: "text-secondary" %></li>
    <li class="breadcrumb-item active" aria-current="page">User Post</li>
  </ol>
</nav>

<h2><%= @post.title %>
  <span><%= add_image(@post.user, 'avatar.png',class: "avatar-large ml-auto",
              crop: :thumb, width:100, height:100) %>
  </span>
</h2>
<h4><%= @post.likes.count %> likes</h4>
  <%# Links for edit new post and back to index %>
  <ul class= "list-inline">
    <%= link_to  post_path(@post), method: :delete, class:"btn btn-secondary" do%>
      <i class="fas fa-trash"></i>
    <% end %>
    <%= link_to edit_post_path(@post), class:"btn btn-success" do%>
      <i class="fas fa-edit"></i>
    <% end %>

    <%# <%= simple_form_for likes_path, method: :post, class: "btn btn-success" do |f| %>
    <% like = current_user.likes.find_by(post: @post) %>
    <% if like.nil? %>
      <form action="/likes" method="post">
        <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
        <input type="hidden" name="like[post_id]" value="<%= @post.id %>">
        <input type="submit" value="Like" class="btn btn-success">
      </form>
      <% else %>
      <form action="<%= like_path(like)%>" method="post">
        <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
        <input type="hidden" name="_method" value="DELETE">
        <input type="submit" value="Unlike" class="btn btn-success">
      </form>
      <% end %>
  </ul>


  <% unless @post.photo.key.nil? %>
     <div class="img-container">
        <%= cl_image_tag @post.photo.key, width: 0.5, crop: :fill %>
     </div>
     <% end %>

    <%= @post.content %>


    <h3>Comments  (<%= @post.comments.count %>) <span  class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle chatroom">
    <i class="fas fa-bars border p-2 rounded"></i>
  </span></h3>

  <div class="collapse" id="navbarHeader">
    <% @post.comments.each  do |c| %>
      <p><%= c.content %></p>
      <%= link_to post_comment_path(c.post, c), method: :delete, class:"btn btn-secondary" do%>
        <i class="fas fa-trash"></i>
      <% end %>
    <% end %>

    <%= simple_form_for([@post, @post.comments.create])   do |f| %>
      <%= f.input :content, as: :text, wrapper_html: {class: "col-6 " } %>
      <%= f.button :submit, class: "btn btn-success"%>
    <% end %>
  </div>
